<!doctype html>
<html amp lang="en-US">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
	<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="ඇත්තටම අපි නිකත් Structure එකක් විතරයිනෙ හැදුවේ. දැනට ඒ ඇති. මේ ලිපියෙන් කතා කරන්නේ Node වලින් Backend එක හදා ගන්න විදිය ගැන." />
<meta name="twitter:title" content="MEAN Stack වලින් Sample Application එකක් Design කරගමු. (PART 02) - The SIGMA" />
<meta name="twitter:image" content="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/mean-stacks-feature.jpg" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="MEAN Stack වලින් Sample Application එකක් Design කරගමු. (PART 02) - The SIGMA" />
<meta property="og:description" content="ඇත්තටම අපි නිකත් Structure එකක් විතරයිනෙ හැදුවේ. දැනට ඒ ඇති. මේ ලිපියෙන් කතා කරන්නේ Node වලින් Backend එක හදා ගන්න විදිය ගැන." />
<meta property="og:url" content="https://danushka96.github.io/sigma/index.php/2019/02/19/mean-stack-sample-application-design-part-02/" />
<meta property="og:site_name" content="The SIGMA" />
<meta property="article:tag" content="angular" />
<meta property="article:tag" content="back-end" />
<meta property="article:tag" content="front-end" />
<meta property="article:tag" content="issueTracker" />
<meta property="article:tag" content="node.js" />
<meta property="article:section" content="web development" />
<meta property="article:published_time" content="2019-02-19T16:06:27+00:00" />
<meta property="article:modified_time" content="2019-02-19T16:08:09+00:00" />
<meta property="og:updated_time" content="2019-02-19T16:08:09+00:00" />
<meta property="og:image" content="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/mean-stacks-feature.jpg" />
<meta property="og:image:secure_url" content="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/mean-stacks-feature.jpg" />
<meta property="og:image:width" content="785" />
<meta property="og:image:height" content="275" />
	<title>MEAN Stack වලින් Sample Application එකක් Design කරගමු. (PART 02) - The SIGMA</title>
		<link rel="canonical" href="https://danushka96.github.io/sigma/index.php/2019/02/19/mean-stack-sample-application-design-part-02/" />
	<script type='text/javascript' src='https://cdn.ampproject.org/v0.js' async></script>
<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>	<script type="application/ld+json">{"@context":"http:\/\/schema.org","publisher":{"@type":"Organization","name":"The Sigma","logo":{"@type":"ImageObject","url":"https:\/\/danushka96.github.io\/sigma\/wp-content\/uploads\/2018\/03\/29136634_567036186984192_1224655159326408704_n.jpg","width":83,"height":60}},"@type":"Article","mainEntityOfPage":"https:\/\/danushka96.github.io\/sigma\/index.php\/2019\/02\/19\/mean-stack-sample-application-design-part-02\/","headline":"MEAN Stack වලින් Sample Application එකක් Design කරගමු. (PART 02)","datePublished":"2019-02-19T16:06:27+00:00","dateModified":"2019-02-19T16:08:09+00:00","author":{"@type":"Person","name":"Danushka Herath"},"image":{"@type":"ImageObject","url":"https:\/\/danushka96.github.io\/sigma\/wp-content\/uploads\/2019\/02\/mean-stacks-feature.jpg","width":785,"height":275},"description":"ඇත්තටම අපි නිකත් Structure එකක් විතරයිනෙ හැදුවේ. දැනට ඒ ඇති. මේ ලිපියෙන් කතා කරන්නේ Node වලින් Backend එක හදා ගන්න විදිය ගැන."}</script>
	<meta name="generator" content="AMP Plugin v1.1.1; mode=reader"><meta name="generator" content="WordPress 5.1.1" />
<meta name="generator" content="Everest Forms 1.4.8" />
	<style amp-custom>
		/* Generic WP styling */

.alignright {
	float: right;
}

.alignleft {
	float: left;
}

.aligncenter {
	display: block;
	text-align: center;
	margin-left: auto;
	margin-right: auto;
}

.amp-wp-enforced-sizes {
	/** Our sizes fallback is 100vw, and we have a padding on the container; the max-width here prevents the element from overflowing. **/
	max-width: 100%;
	margin: 0 auto;
}


/*
 * Prevent cases of amp-img converted from img to appear with stretching by using object-fit to scale.
 * See <https://github.com/ampproject/amphtml/issues/21371#issuecomment-475443219>.
 * Also use object-fit:contain in worst case scenario when we can't figure out dimensions for an image.
 */
amp-img.amp-wp-enforced-sizes[layout=intrinsic] > img,
.amp-wp-unknown-size > img {
	object-fit: contain;
}

amp-fit-text blockquote,
amp-fit-text h1,
amp-fit-text h2,
amp-fit-text h3,
amp-fit-text h4,
amp-fit-text h5,
amp-fit-text h6 {
	font-size: inherit;
}

/**
 * Override a style rule in Twenty Sixteen and Twenty Seventeen.
 * It set display:none for audio elements.
 * This selector is the same, though it adds body and uses amp-audio instead of audio.
 */
body amp-audio:not([controls]) {
	display: inline-block;
	height: auto;
}

/* Template Styles */

.amp-wp-content,
.amp-wp-title-bar div {
		margin: 0 auto;
	max-width: 750px;
	}

html {
	background: #0a89c0;
}

body {
	background: #fff;
	color: #353535;
	font-family: Georgia, 'Times New Roman', Times, Serif;
	font-weight: 300;
	line-height: 1.75em;
}

p,
ol,
ul,
figure {
	margin: 0 0 1em;
	padding: 0;
}

a,
a:visited {
	color: #0a89c0;
}

a:hover,
a:active,
a:focus {
	color: #353535;
}

/* Quotes */

blockquote {
	color: #353535;
	background: rgba(127,127,127,.125);
	border-left: 2px solid #0a89c0;
	margin: 8px 0 24px 0;
	padding: 16px;
}

blockquote p:last-child {
	margin-bottom: 0;
}

/* UI Fonts */

.amp-wp-meta,
.amp-wp-header div,
.amp-wp-title,
.wp-caption-text,
.amp-wp-tax-category,
.amp-wp-tax-tag,
.amp-wp-comments-link,
.amp-wp-footer p,
.back-to-top {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen-Sans", "Ubuntu", "Cantarell", "Helvetica Neue", sans-serif;
}

/* Header */

.amp-wp-header {
	background-color: #0a89c0;
}

.amp-wp-header div {
	color: #fff;
	font-size: 1em;
	font-weight: 400;
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: .875em 16px;
	position: relative;
}

.amp-wp-header a {
	color: #fff;
	text-decoration: none;
}


.amp-wp-header .amp-wp-site-icon {
	/** site icon is 32px **/
	background-color: #fff;
	border: 1px solid #fff;
	border-radius: 50%;
	position: absolute;
	right: 18px;
	top: 10px;
}

/* Article */

.amp-wp-article {
	color: #353535;
	font-weight: 400;
	margin: 1.5em auto;
	max-width: 840px;
	overflow-wrap: break-word;
	word-wrap: break-word;
}

/* Article Header */

.amp-wp-article-header {
	align-items: center;
	align-content: stretch;
	display: flex;
	flex-wrap: wrap;
	justify-content: space-between;
	margin: 1.5em 16px 0;
}

.amp-wp-title {
	color: #353535;
	display: block;
	flex: 1 0 100%;
	font-weight: 900;
	margin: 0 0 .625em;
	width: 100%;
}

/* Article Meta */

.amp-wp-meta {
	color: #696969;
	display: inline-block;
	flex: 2 1 50%;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0 0 1.5em;
	padding: 0;
}

.amp-wp-article-header .amp-wp-meta:last-of-type {
	text-align: right;
}

.amp-wp-article-header .amp-wp-meta:first-of-type {
	text-align: left;
}

.amp-wp-byline amp-img,
.amp-wp-byline .amp-wp-author {
	display: inline-block;
	vertical-align: middle;
}

.amp-wp-byline amp-img {
	border: 1px solid #0a89c0;
	border-radius: 50%;
	position: relative;
	margin-right: 6px;
}

.amp-wp-posted-on {
	text-align: right;
}

/* Featured image */

.amp-wp-article-featured-image {
	margin: 0 0 1em;
}
.amp-wp-article-featured-image amp-img {
	margin: 0 auto;
}
.amp-wp-article-featured-image.wp-caption .wp-caption-text {
	margin: 0 18px;
}

/* Article Content */

.amp-wp-article-content {
	margin: 0 16px;
}

.amp-wp-article-content ul,
.amp-wp-article-content ol {
	margin-left: 1em;
}

.amp-wp-article-content .wp-caption {
	max-width: 100%;
}

.amp-wp-article-content amp-img {
	margin: 0 auto;
}

.amp-wp-article-content amp-img.alignright {
	margin: 0 0 1em 16px;
}

.amp-wp-article-content amp-img.alignleft {
	margin: 0 16px 1em 0;
}

/* Captions */

.wp-caption {
	padding: 0;
}

.wp-caption.alignleft {
	margin-right: 16px;
}

.wp-caption.alignright {
	margin-left: 16px;
}

.wp-caption .wp-caption-text {
	border-bottom: 1px solid #c2c2c2;
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0;
	padding: .66em 10px .75em;
}

/* AMP Media */

.alignwide,
.alignfull {
	clear: both;
}

amp-carousel {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}
amp-iframe,
amp-youtube,
amp-instagram,
amp-vine {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}

.amp-wp-article-content amp-carousel amp-img {
	border: none;
}

amp-carousel > amp-img > img {
	object-fit: contain;
}

.amp-wp-iframe-placeholder {
	background: #c2c2c2 url( https://danushka96.github.io/sigma/wp-content/plugins/amp/assets/images/placeholder-icon.png) no-repeat center 40%;
	background-size: 48px 48px;
	min-height: 48px;
}

/* Article Footer Meta */

.amp-wp-article-footer .amp-wp-meta {
	display: block;
}

.amp-wp-tax-category,
.amp-wp-tax-tag {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 1.5em 16px;
}

.amp-wp-comments-link {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	text-align: center;
	margin: 2.25em 0 1.5em;
}

.amp-wp-comments-link a {
	border-style: solid;
	border-color: #c2c2c2;
	border-width: 1px 1px 2px;
	border-radius: 4px;
	background-color: transparent;
	color: #0a89c0;
	cursor: pointer;
	display: block;
	font-size: 14px;
	font-weight: 600;
	line-height: 18px;
	margin: 0 auto;
	max-width: 200px;
	padding: 11px 16px;
	text-decoration: none;
	width: 50%;
	-webkit-transition: background-color 0.2s ease;
			transition: background-color 0.2s ease;
}

/* AMP Footer */

.amp-wp-footer {
	border-top: 1px solid #c2c2c2;
	margin: calc(1.5em - 1px) 0 0;
}

.amp-wp-footer div {
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: 1.25em 16px 1.25em;
	position: relative;
}

.amp-wp-footer h2 {
	font-size: 1em;
	line-height: 1.375em;
	margin: 0 0 .5em;
}

.amp-wp-footer p {
	color: #696969;
	font-size: .8em;
	line-height: 1.5em;
	margin: 0 85px 0 0;
}

.amp-wp-footer a {
	text-decoration: none;
}

.back-to-top {
	bottom: 1.275em;
	font-size: .8em;
	font-weight: 600;
	line-height: 2em;
	position: absolute;
	right: 16px;
}
		td, th {
text-align: left;
}

a, a:active, a:visited {
text-decoration: underline;
}
/* Inline stylesheets */
:root:not(#_):not(#_):not(#_):not(#_):not(#_) .amp-wp-19fae44{display:block}	</style>
</head>

<body data-rsssl=1 class="">

<header id="top" class="amp-wp-header">
	<div>
		<a href="https://danushka96.github.io/sigma/">
									<span class="amp-site-title">
				The SIGMA			</span>
		</a>

					</div>
</header>

<article class="amp-wp-article">
	<header class="amp-wp-article-header">
		<h1 class="amp-wp-title">MEAN Stack වලින් Sample Application එකක් Design කරගමු. (PART 02)</h1>
			<div class="amp-wp-meta amp-wp-byline">
					<amp-img src="https://secure.gravatar.com/avatar/81f32af4149adb5de35857259b875c31?s=24&#038;d=mm&#038;r=g" alt="Danushka Herath" width="24" height="24" layout="fixed"></amp-img>
				<span class="amp-wp-author author vcard">Danushka Herath</span>
	</div>
<div class="amp-wp-meta amp-wp-posted-on">
	<time datetime="2019-02-19T21:36:27+00:00">
		2 months ago	</time>
</div>
	</header>

	<figure class="amp-wp-article-featured-image wp-caption">
	<amp-img width="750" height="263" src="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/mean-stacks-feature.jpg" class="attachment-large size-large wp-post-image amp-wp-enforced-sizes" alt="" srcset="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/mean-stacks-feature.jpg 785w, https://danushka96.github.io/sigma/wp-content/uploads/2019/02/mean-stacks-feature-300x105.jpg 300w, https://danushka96.github.io/sigma/wp-content/uploads/2019/02/mean-stacks-feature-768x269.jpg 768w" layout="intrinsic"><noscript><img width="750" height="263" src="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/mean-stacks-feature.jpg" class="attachment-large size-large wp-post-image" alt="" sizes="(max-width: 750px) 100vw, 750px"></noscript></amp-img>	</figure>

	<div class="amp-wp-article-content">
		<span class="rt-reading-time amp-wp-19fae44"><span class="rt-label">Reading Time: </span> <span class="rt-time">6</span> <span class="rt-label rt-postfix">minutes</span></span>
<p></p>



<p>අපි <a href="https://danushka96.github.io/sigma/index.php/2019/02/19/mean-stack-sample-application-1/">කලින් ලිපියෙන්</a> කතා කලා කොහොමද FrontEnd එක angular වලින් Design කරගන්නේ කියලා. ඇත්තටම අපි නිකත් Structure එකක් විතරයිනෙ හැදුවේ. දැනට ඒ ඇති. මේ ලිපියෙන් කතා කරන්නේ Node වලින් Backend එක හදා ගන්න විදිය ගැන. බලමු හදා ගන්නේ කොහොමද කියලා.</p>



<p>මුලින්ම අපි කලින් fontEnd කියලා අලුත් Project එකක්  හැදුව තැනම අලුත් folder එකක් හදනවා Backend කියලා මේ විදියට.</p>



<pre class="wp-block-preformatted">mkdir backend </pre>



<p>දැන් මම ඉන්න Directory එක වෙනස් කර ගන්නවා අලුතින් හදපු Folder එකට</p>



<pre class="wp-block-preformatted">cd backend </pre>



<p>දැන් අලුත් project එකක් initialise කරගන්නවා මේ විදියට npm command එකෙන්.</p>



<pre class="wp-block-preformatted"> npm init -y </pre>



<p>අපේ project එකේ <a href="https://dev.to/dhruv/writing-es6-in-your-nodejs-applications-33jk">ES6 Features</a> යොද ගන්න නම් අපිට Babel compiler එක use කරන්න වෙනවා. ඒකට  babel-cli එක සහ babel-preset-env එක මේ විදියට install කරගන්න පුළුවන්.</p>



<pre class="wp-block-preformatted"> npm install --save-dev babel-cli babel-preset-env </pre>



<p>මේක install වෙලා ඉවර වුණාට පස්සේ අපි කරන්නේ Babel config file එක හදා ගන්න එක. ඒකට .babelrc නමින් අලුත් file එකක් හදලා ඒකේ content එක විදියට මේක දාගන්න. </p>



<pre class="wp-block-preformatted"><code>{<br>  "presets": ["env"]<br>}</code> </pre>



<p>හරි දැන් Babel compiler එක use කරන්න අපිට පුළුවන්</p>



<h3 id="169d">Installing babel-watch</h3>



<p>මේක අපි යොදා ගන්නේ code එකේ change එකක් වෙනකොට autoම server එක restart කර ගන්න. ඒක ගොඩක් ලේසියි Manual restart කරනවට වඩා. මේක Install කරගන්නේ මෙහෙමයි.</p>



<pre class="wp-block-preformatted"> npm install babel-watch --save-dev </pre>



<p>ඊට පස්සේ අපි කරන්න ඕන Package.json එකට මේක add කරගන්න එක. ඒකට package.json file එක open කරගෙන මේක paste කරගන්න scripts කියලා තියෙන කොටස ඇතුලෙ.</p>



<pre class="wp-block-preformatted"> <br><code>"scripts": {<br>    "dev": "babel-watch server.js"<br>  }</code> </pre>



<p>මේක අපි add කරේ මේ ලිපියේ අන්තිමට අපි server එක start කරන්න මේ command එක use කරන නිසා. </p>



<h3 id="a925">Installing Express</h3>



<p>අපි දැන් Express Framework එක add කරගන්න යන්නේ. මේ steps ටික follow කරන්න</p>



<pre class="wp-block-preformatted"> npm install express </pre>



<p>අපි database එකක් විදියට යොදා ගන්න mogodb driver එකත් මේ විදියට install කරගන්න.</p>



<pre class="wp-block-preformatted"> npm install mongoose </pre>



<p>ඒ වගේම මේකෙදි අපි backend එකේ ඉදන් frontend එකට data යවනවා. ඒක නිසා අපිට ඕන වෙනවා cors package එකත්.</p>



<pre class="wp-block-preformatted"> npm install cors </pre>



<p>මේ cors කියන package එක Express server එකට middleware එකක් විදියට වැඩ කරනවා. ඒ කියන්නේ Cross-Origin Resource Sharing මේකෙදි වෙන්නේ මොකක් හරි request එකක header එකේ අපි allow කරලා තියෙන content එකක් තියෙනවද කියලා බලනවා Domain එකෙන් පිටින් එන requests වලට.</p>



<h3 id="1b57">Implementing The Server</h3>



<p>අපෙ Baisc Packages Installation එක ඉවර වුණාට පස්සේ අපි දැන් බලන්න හදන්නේ Server එක implement කරගන්න විදිය. </p>



<h4 id="4908">Implementing A Basics Node.js/Express Server</h4>



<p>මුලින්ම අපි බලමු Baisc server එකක් හදා ගන්න විදිය.. මේකට project එකට අලුතින් file එකක් add කරන්න ඕන server.js කියලා. ඒකේ content එක මේ වගේ හදා ගන්න.</p>



<pre class="wp-block-preformatted"><br><code>import express from 'express';</code><br><code>const app = express();<br>app.get('/', (req, res) =&gt; res.send('Hello World!'));<br>app.listen(4000, () =&gt; console.log(`Express server running on port 4000`));</code> </pre>



<p>දැන් අපි මේක run කරලා බලමු. ඒකට මේ command එක use කරන්න. </p>



<pre class="wp-block-preformatted">npm run dev<br></pre>



<p>මේ dev කියන වචනේ භිවිතා කරන්න පුළුවන් වුණේ අපි කලින් package.json එකට add කරපු නිසා. දැන් මේ url එක ( http://localhost:4000 ) web browser එකක් දැම්මොත් අපිට hello wold කියලා output එකක් බලා ගන්න පුළුවන්.</p>



<p>මොනවා හරි error එකක් ආවොත් fix කරගන්න try එකක් දීලා බැරි වුනොත් node_modules කියන folder එක backend එකේන delete කරලා package.json එක මේ විදියට හදාගෙන npm install කියන command එක run කරගන්න. </p>



<pre class="wp-block-preformatted">{<br>  "name": "backEnd",<br>  "version": "1.0.0",<br>  "description": "",<br>  "main": "index.js",<br>  "scripts": {<br>    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",<br>    "dev": "babel-watch server.js"<br>  },<br>  "keywords": [],<br>  "author": "",<br>  "license": "ISC",<br>  "devDependencies": {<br>    "babel-cli": "^6.26.0",<br>    "babel-preset-env": "^1.7.0",<br>    "babel-watch": "^2.0.8"<br>  },<br>  "dependencies": {<br>    "cors": "^2.8.5",<br>    "express": "^4.16.4",<br>    "mongoose": "^5.4.13"<br>  }<br>}<br></pre>



<h3 id="0c6d">Extending The Server Implementation</h3>



<p>දැන් අපි කරන්න යන්නේ මේ server එක අපිට ඕන විදියට වැඩි දියුණු කරගන්න එක. මේකෙදි අපි ප්‍රධාන Task 5ක් කරන්න යනවා. ඒවා තමයි</p>



<ul><li>GET request එකකින් list එක retrieve කරගන්න එක</li><li>GET request එකකින් issue id එකකට අදාල record එකක් ගන්න එක</li><li>POST request එකකින් අලුත් issue එකක් insert කරගන්න එක</li><li>POST request එකකින් දැනට තියෙන record එකක් update කරගන්න එක</li><li>GET request එකකින් issue එකක් delete කරගන්න එක</li></ul><p>මුලින් අපි හදපු server.js එක මේ විදියට හදා ගන්න.</p>



<pre class="wp-block-preformatted">const app = express();<br> const router = express.Router();<br><br> app.use(cors());<br> app.use(bodyParser.json());<br><br> mongoose.connect('mongodb://[server]/issues');<br> const connection = mongoose.connection;<br><br> connection.once('open', () =&gt; {<br>     console.log('MongoDB database connection established successfully!');<br> });<br><br> app.use('/', router);<br> app.listen(4000, () =&gt; console.log(<code>Express server running on port 4000</code>));</pre>



<p>මේකෙ mongoose.connect එක ඇතුලෙ තියෙන server එක වෙනුවට ඔයගෙ තියෙන remote server එකක් නැත්නම් local mongo server එක දාගන්න. local server එකක් නම් server වෙනුවට local කියලා දාගන්න. ඒ වගේම ඔයාගෙ mongo server එක ඇතුලේ issues කියලා අලුත් collection එකකුත් හදා ගන්න. </p>



<p>අපිට හැම තිස්සෙම issues refer කරන්න වෙන නිසා දැන් කරන්න හදන්නේ අලුතින් issue කියලා model එකක් හදා ගන්න එක. ඒකට ඔයාගෙ backend folder එක ඇතුලේ අලුතින් <strong>models </strong>කියලා folder එකක් හදාගෙන ඒක ඇතුලේ <strong>Issue.js </strong>කියලා file එකක් create කරගන්න. ඒකේ content එකට මේක paste කරගන්න. මෙකෙ අපි ලියන්නේ අපේ issue එකට ඕන කරන properties ටික.</p>



<pre class="wp-block-preformatted"> import mongoose from 'mongoose';<br> const Schema = mongoose.Schema;<br> let Issue = new Schema({<br>     title: {<br>         type: String<br>     },<br>     responsible: {<br>         type: String <br>     },<br>     description: {<br>         type: String<br>     },<br>     severity: {<br>         type: String<br>     },<br>     status: {<br>         type: String,<br>         default: 'Open'<br>     }<br> });<br> export default mongoose.model('Issue', Issue);</pre>



<p>දැන් අපි මේ හදා ගත්ත අලුත් model එක server.js එකට import කරගන්න ඕන. ඒකට Server.js එකේ මේ විදියට import command එකක් උඩින් ලියා ගන්න</p>



<pre class="wp-block-preformatted">import Issue from './models/Issue';</pre>



<h3 id="aaa0">Retrieving All Issues</h3>



<p>අපි දැන් කරන්න යන්නේ අපෙ පළවෙනි task එක. ඒ කියන්නේ issues list එකම retrieve කරගන්න එක. ඒකට මේ Code එක server.js එකේ ලියා ගන්න. </p>



<pre class="wp-block-preformatted"> router.route('/issues').get((req, res) =&gt; {<br>     Issue.find((err, issues) =&gt; {<br>         if (err)<br>             console.log(err);<br>         else<br>             res.json(issues);<br>     });<br> });</pre>



<p>මේකෙ වෙන වැඩේ සරලවම කිවුවොත් router එකට ‘/issues’ කියලා get request එකක් ආවොත් එයා Issue කියන Schema එකේ තියෙන records ඔක්කොම අරගෙන json response එකක් විදියට එළියට දෙනවා. ඕන නම් ඔයාලට පුළුවන් මේ Code එක වෙනස් කර කර බලන්න මොන වගේ දේවල්ද කරන්න පුුළුවන් කියලා. </p>



<p>මම මේ වගේ Methods ඔක්කොම ලියන විදිය කියලා අන්තිමට server.js එකේ තියෙන්න ඕන content එක දාන්නම්</p>



<h3 id="7fc2">Retrieving An Issue By ID</h3>



<p>මේකෙදි කරන්නේ අපි issue එකේ id එක දුන්නාම ඒ ID එකට අදාල record එක විතරක් අරගෙන දෙන ඒක. ඒක ලියන්නේ මෙහෙමයි.</p>



<pre class="wp-block-preformatted">router.route('/issues/:id').get((req, res) =&gt; {<br>     Issue.findById(req.params.id, (err, issue) =&gt; {<br>         if (err)<br>             console.log(err);<br>         else<br>             res.json(issue);<br>     })<br> });</pre>



<p>:id එකෙන් කියන්නේ අපිට හොයා ගන්න ඕන කරන id එක router parameter එකක් විදියට දෙනවා කියල. එතකොට අපි කලින් කතා කලා වගේ Schema එකට කියනවා අදාල id එක තියෙන record එක json object එකක් විදියට එලියට දෙන්න කියල.</p>



<h3 id="e24e">Adding New Issues</h3>



<p>අපි කලින් ක්‍රම දෙකේදිම කතා කලේ GET method එකෙන් data එකක් ගන්න විදිය. හැබැයි දැන් අපිට ඕන වෙනවා අලුතින් data එකක් නැත්නම් issue එකක් store කරගන්න. ඒකට අපිට data එක යවන්න වෙන නිසා අපිට post method එක යොදා ගන්න සිද්ධ වෙනවා. ඒක කරන්නේ මෙහෙමයි</p>



<pre class="wp-block-preformatted">router.route('/issues/add').post((req, res) =&gt; {<br>     let issue = new Issue(req.body);<br>     issue.save()<br>         .then(issue =&gt; {<br>             res.status(200).json({'issue': 'Added successfully'});<br>         })<br>         .catch(err =&gt; {<br>             res.status(400).send('Failed to create new record');<br>         });<br> });</pre>



<p>මේ විදියට එක post request එකේ body එකේ තියෙන data ටිකෙන් අපි අලුත් issue object එකක් හදලා ඒක db එකේ save කරගන්නවා.</p>



<h3 id="3f19">Updating Issues</h3>



<p>මේකෙදි අපිට වැඩ දෙකක් කරන්න වෙනවා. මුලින් අපි දෙන ID එකට අදාල record එක හොයා ගන්න වෙනවාත ඊට පස්සේ ඒකෙ තියෙන Data වෙනුවට අපි අලුතින් එවන ඒවා දාලා ඒක save කරන්න වෙනවා. මේ වැඩේ කරගන්නේ කොහොමද කියලා බලමු. </p>



<pre class="wp-block-preformatted">router.route('/issues/update/:id').post((req, res) =&gt; {<br>     Issue.findById(req.params.id, (err, issue) =&gt; {<br>         if (!issue)<br>             return next(new Error('Could not load Document'));<br>         else {<br>             issue.title = req.body.title;<br>             issue.responsible = req.body.responsible;<br>             issue.description = req.body.description;<br>             issue.severity = req.body.severity;<br>             issue.status = req.body.status;<br>             issue.save().then(issue =&gt; {<br>                 res.json('Update done');<br>             }).catch(err =&gt; {<br>                 res.status(400).send('Update failed');<br>             });<br>         }<br>     });<br> });</pre>



<p>ඔයාලට පේනවා ඇති අපි මුලින්ම දෙන ID එකට අදාල records තියෙනවද කියලා check කරලා හම්බ වුණේ නැත්නම් error එකක් දෙනවා. හම්බවුණොත් අපි එකින් එක replace කරගෙන යනවා අපි දෙන අලුත් data set එක්ත් එක්ක. </p>



<h3 id="3ef0">Deleting Issues</h3>



<p>මේක ගොඩක් සරලයි. සාමාන්‍ය විදියට id එකකින් අදාල issue එක හොයාගෙන delete කරලා දාන්න තියෙන්නේ. අපි data එවන්නේ නැති නිසා සාමාන්‍ය get request එකක් මේකට භවිතා කරන්න පුළුවන්. </p>



<pre class="wp-block-preformatted">router.route('/issues/delete/:id').get((req, res) =&gt; {<br>     Issue.findByIdAndRemove({_id: req.params.id}, (err, issue) =&gt; {<br>         if (err)<br>             res.json(err);<br>         else<br>             res.json('Removed successfully');<br>     });<br> });</pre>



<p>මේක ඉවර වුණාම අපේ Basic task ටික ඉවර වෙනවා. දැන් අපි බලමු අන්තිමට අපිට හැදිලා තියෙන server.js එක මොන වගේ එකක්ද කියලා. මේක දිහා බලලා ඔයාලගේ code එකේ අඩුපාඩු තිබුණොත් හදාගන්න.</p>



<pre class="wp-block-preformatted"> import express from 'express';<br> import cors from 'cors';<br> import bodyParser from 'body-parser';<br> import mongoose from 'mongoose';<br> import Issue from './models/Issue';<br> const app = express();<br> const router = express.Router();<br> app.use(cors());<br> app.use(bodyParser.json());<br> mongoose.connect('mongodb://[server]/issues');<br> const connection = mongoose.connection;<br> connection.once('open', () =&gt; {<br>     console.log('MongoDB database connection established successfully!');<br> });<br> router.route('/issues/add').post((req, res) =&gt; {<br>     let issue = new Issue(req.body);<br>     issue.save()<br>         .then(issue =&gt; {<br>             res.status(200).json({'issue': 'Added successfully'});<br>         })<br>         .catch(err =&gt; {<br>             res.status(400).send('Failed to create new record');<br>         });<br> });<br> router.route('/issues').get((req, res) =&gt; {<br>     Issue.find((err, issues) =&gt; {<br>         if (err)<br>             console.log(err);<br>         else<br>             res.json(issues);<br>     });<br> });<br> router.route('/issues/:id').get((req, res) =&gt; {<br>     Issue.findById(req.params.id, (err, issue) =&gt; {<br>         if (err)<br>             console.log(err);<br>         else<br>             res.json(issue);<br>     })<br> });<br> router.route('/issues/update/:id').post((req, res) =&gt; {<br>     Issue.findById(req.params.id, (err, issue) =&gt; {<br>         if (!issue)<br>             return next(new Error('Could not load Document'));<br>         else {<br>             issue.title = req.body.title;<br>             issue.responsible = req.body.responsible;<br>             issue.description = req.body.description;<br>             issue.severity = req.body.severity;<br>             issue.status = req.body.status;<br>             issue.save().then(issue =&gt; {<br>                 res.json('Update done');<br>             }).catch(err =&gt; {<br>                 res.status(400).send('Update failed');<br>             });<br>         }<br>     });<br> });<br> router.route('/issues/delete/:id').get((req, res) =&gt; {<br>     Issue.findByIdAndRemove({_id: req.params.id}, (err, issue) =&gt; {<br>         if (err)<br>             res.json(err);<br>         else<br>             res.json('Removed successfully');<br>     });<br> });<br> app.use('/', router);<br> app.listen(4000, () =&gt; console.log(<code>Express server running on port 4000</code>));</pre>



<h2> Testing The Server With Postman </h2>



<p>Node වලින් backend එක හදා ගත්තට පස්සේ අපිට test කරගන්න පුළුවන් tool එකක් තමයි PostMan කියන්නේ. ඒක නැත්නම් <a href="https://www.getpostman.com/">මෙතනින් </a>Download කරගන්න. ඒකෙන් අපේ backend එකෙන් එලියට Data ගන්න පුළුවන්ද කියලා check කරගන්න පුළුවන්. </p>



<figure class="wp-block-image"><amp-img src="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/0_LjsHj5lPDNO0Ehdl.png" alt="" class="wp-image-1903 amp-wp-enforced-sizes" srcset="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/0_LjsHj5lPDNO0Ehdl.png 800w, https://danushka96.github.io/sigma/wp-content/uploads/2019/02/0_LjsHj5lPDNO0Ehdl-300x191.png 300w, https://danushka96.github.io/sigma/wp-content/uploads/2019/02/0_LjsHj5lPDNO0Ehdl-768x490.png 768w" width="800" height="510" layout="intrinsic"><noscript><img src="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/0_LjsHj5lPDNO0Ehdl.png" alt="" class="wp-image-1903" sizes="(max-width: 800px) 100vw, 800px" width="800" height="510"></noscript></amp-img></figure><p>Install කරගෙන ඉවර වුණාට පස්සේ node server එක run කරලා මේ වගේ request ගහලා බලන්න අපි හදපු routes වලට data එනවද කියලා</p>



<figure class="wp-block-image"><amp-img src="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/0_m3eRdTp5VIQ89PFg.png" alt="" class="wp-image-1904 amp-wp-enforced-sizes" srcset="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/0_m3eRdTp5VIQ89PFg.png 800w, https://danushka96.github.io/sigma/wp-content/uploads/2019/02/0_m3eRdTp5VIQ89PFg-300x191.png 300w, https://danushka96.github.io/sigma/wp-content/uploads/2019/02/0_m3eRdTp5VIQ89PFg-768x490.png 768w" width="800" height="510" layout="intrinsic"><noscript><img src="https://danushka96.github.io/sigma/wp-content/uploads/2019/02/0_m3eRdTp5VIQ89PFg.png" alt="" class="wp-image-1904" sizes="(max-width: 800px) 100vw, 800px" width="800" height="510"></noscript></amp-img></figure><p>හරි මේ ලිපියෙන් අපි කතා කලේ Backend එක Nodejs වලින් Design කරගන්නේ කොහොමද කියලා. තේරුණේ නැති තැනක් තියෙනවා නම් Message එකක් දාන්න. ඊළඟ ලිපියෙන් කතා කරන්නේ අපි හදා ගත්ත Front එකයි Back එකයි Connect කරගන්න විදිය ගැන… </p>
<div id="emojics-root"></div>	</div>

	<footer class="amp-wp-article-footer">
			<div class="amp-wp-meta amp-wp-tax-category">
		Categories: <a href="https://danushka96.github.io/sigma/index.php/category/web-development/angular-js/" rel="category tag">angular.js</a>, <a href="https://danushka96.github.io/sigma/index.php/category/web-development/mean-stack/" rel="category tag">mean stack</a>, <a href="https://danushka96.github.io/sigma/index.php/category/web-development/node-js/" rel="category tag">node.js</a>, <a href="https://danushka96.github.io/sigma/index.php/category/web-development/" rel="category tag">web development</a>	</div>

	<div class="amp-wp-meta amp-wp-tax-tag">
		Tags: <a href="https://danushka96.github.io/sigma/index.php/tag/angular/" rel="tag">angular</a>, <a href="https://danushka96.github.io/sigma/index.php/tag/back-end/" rel="tag">back-end</a>, <a href="https://danushka96.github.io/sigma/index.php/tag/front-end/" rel="tag">front-end</a>, <a href="https://danushka96.github.io/sigma/index.php/tag/issuetracker/" rel="tag">issueTracker</a>, <a href="https://danushka96.github.io/sigma/index.php/tag/node-js/" rel="tag">node.js</a>	</div>
		<div class="amp-wp-meta amp-wp-comments-link">
		<a href="https://danushka96.github.io/sigma/index.php/2019/02/19/mean-stack-sample-application-design-part-02/#respond">
			Leave a Comment		</a>
	</div>
	</footer>
</article>

<footer class="amp-wp-footer">
	<div>
		<h2>The SIGMA</h2>
		<a href="#top" class="back-to-top">Back to top</a>
	</div>
</footer>



</body>
</html>
